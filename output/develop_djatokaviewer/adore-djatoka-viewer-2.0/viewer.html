<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN"
  "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" >
 <head>
 <meta name="author" content="Ruven Pillay &lt;ruven@users.sourceforge.netm&gt;"/>
 <meta name="author" content="Ryan Chute &lt;rchute@users.sourceforge.netm&gt;"/>
 <meta name="keywords" content="djatoka IIPImage Ajax IIP Zooming Streaming High Resolution Mootools"/>
 <meta name="description" content="djatoka IIPImage Viewer: High Resolution Remote Image Streaming Viewing"/>
 <meta name="copyright" content="&copy; 2003-2008 Ruven Pillay"/>

 <link rel="stylesheet" type="text/css" media="all" href="css/iip.compressed.css" />
 <link rel="stylesheet" type="text/css" media="all" href="css/carousel.css" />
 <link rel="shortcut icon" href="images/djatoka.16x16.png" />
 <title>Herbarium Viewer, Herbarium Wien</title>

 <script type="text/javascript" src="javascript/mootools-1.2.5-core-nc.js"></script>
 <script type="text/javascript" src="javascript/mootools-1.2.5.1-more.js"></script>
 <script type="text/javascript" src="javascript/moocarousel_v1.0.js"></script>
 <script type="text/javascript" src="javascript/iipmooviewer-1.1.js"></script>

 <script type="text/javascript">
/*
viewer.html?requestfilename=requ1&filename=req2&specimenID=444
*/

var server = 'http://localhost/djatoka/resolver.php';
var images = 'http://memory.loc.gov/gmd/gmd433/g4330/g4330/np000066.jp2';
var credit = '<a href="http://herbarium.univie.ac.at/">Herbarium Wien</a> Rainer H.';// Copyright or information message

var re={};

//ObtainURLParametersifpresent
var query=location.href.substring(location.href.indexOf('?')+1);
var vars=query.split('&');
for(var i=0;i<vars.length;i++){
	var pair=vars[i].split('=');
	if(pair[0]=='requestfilename'||pair[0]=='filename'||pair[0]=='specimenID'){
		if(pair[1].indexOf('#')>0){
			pair[1]=pair[1].substring(0,pair[1].length-1);
		}
		if(pair[0]=='requestfilename'){
			images=pair[1];
		}else{
			re[pair[0]]=pair[1];
		}
	}
}

// Create our viewer object - note: must assign this to the 'iip' variable.
// See documentation for more details of options
iip=new IIP( "targetframe",{
	image: images,
	server: server,
	credit: credit, 
	zoom: 1,
	render: 'random',
	showNavButtons: true
});

var images=[['images/image1.jpg','Flower 2'],['images/image1.jpg','Flower 2'],['images/image1.jpg','Flower 3'],['images/image1.jpg','Flower 4']]


window.addEvent('domready', function() {
	/*var jsonRequest=new Request.JSON({
		url: 'http://site.com/tellMeAge.php',
		onSuccess: function(images){
			makeCarousel(images);
		}
	}).get({'firstName': 'John', 'lastName': 'Doe'});
	*/
	 makeCarousel(images);
});


function loadnew(requestfilename){
	url=location.href.replace(/(.*)(requestfilename=)([^&]*)&(.*)/i,'$1$2'+requestfilename+'&$4');
	//alert(url);
	document.location.href=url;
}

function makeCarousel(images){
	images.each( function(val){
		var carousel=new Element('div',{
			html: '<div class="carousel2_items" onclick="loadnew(\'555'+val[0]+'\')"><img src="'+val[0]+'"><br><span class="text">'+val[1]+'</span><br></div>'
		});
		carousel.injectInside($('carousel2_items_container'));
	});
	var c2_ns=Math.ceil(images.length/3);
	var carousel2 = new MooCarousel('carousel2_wrapper','carousel2_items_container','carousel2_moveleft','carousel2_moveright',c2_ns,220, true); //c_ns= number of slides , c_sss = slide step size
}

 </script>

</head>
<body>
<div style="width:99%;height:99%;margin-left:auto;margin-right:auto" id="targetframe"></div>
  
<div id="carousel2_container">
<a href="javascript:void(0);" id="carousel2_moveleft"><span id="carousel2_container_l" class="carousel_container_l sprite_icon" ></span></a>
<div id="carousel2_wrapper">
 <div id="carousel2_items_container" ></div>
</div>
<a href="javascript:void(0);" id="carousel2_moveright"> <span id="carousel2_container_r" class="carousel_container_r sprite_icon"></span> </a>
<div class="clearfix"></div>
</div>
 </body>
</html>
