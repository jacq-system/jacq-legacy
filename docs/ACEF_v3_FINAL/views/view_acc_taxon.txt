SELECT
 ts.taxonID as 'AcceptedTaxonID',
 
 'Plantae' as 'Kingdom',
 'Magnoliophyta' as 'Phylum',
 'Magnoliopsida' as 'Class',
 'Magnoliales' as 'Order',
 '' as 'Superfamily',
 
 tf.family as 'Family',
 tg.genus as 'Genus',

 'SubGenusName' as 'SubGenusName',
 'Species' as 'Species',

 CONCAT(
  IF(te.epithetID ,CONCAT(' ',         te.epithet ,' ',ta.author ),''),
  IF(te1.epithetID,CONCAT(' subsp. ',  te1.epithet,' ',ta1.author),''),
  IF(te2.epithetID,CONCAT(' var. ',    te2.epithet,' ',ta2.author),''),
  IF(te3.epithetID,CONCAT(' subvar. ', te3.epithet,' ',ta3.author),''),
  IF(te4.epithetID,CONCAT(' forma ',   te4.epithet,' ',ta4.author),''),
  IF(te5.epithetID,CONCAT(' subforma ',te5.epithet,' ',ta5.author),'')
 ) as 'AuthorString',

/*
 CASE
  WHEN te5.epithetID THEN ta5.author
  WHEN te4.epithetID THEN ta4.author
  WHEN te3.epithetID THEN ta3.author
  WHEN te2.epithetID THEN ta2.author
  WHEN te1.epithetID THEN ta1.author
  ELSE ta.author
 END as 'AuthorTeam',
 
 CASE
  WHEN te5.epithetID THEN te5.epithet
  WHEN te4.epithetID THEN te4.epithet
  WHEN te3.epithetID THEN te3.epithet
  WHEN te2.epithetID THEN te2.epithet
  WHEN te1.epithetID THEN te1.epithet
  ELSE te.epithet
 END as 'SecondEpithet',
 
 IF(SecondEpithet=te.epithet AND CHAR_LENGTH(ta.author)=0),ta.author,AuthorTeam) as 'test',
*/

 '' as 'GSDNameStatus',
 tts.status_sp2000 as 'Sp2000NameStatus',
 
 'No' as 'IsFossil',
 'terrestial' as 'LifeZone',
 '' as 'AdditionalData',
 
 'LTSSpecialist' as 'LTSSpecialist',
 'LTSDate' as 'LTSDate',
 
 CONCAT('http://herbarium.botanik.univie.ac.at/annonaceae/listSynonyms.php?ID=',ts.taxonID) as 'SpeciesURL',
 
 'GSDTaxonGUI' as 'GSDTaxonGUI',
 'GSDNameGUI' as 'GSDNameGUI'

FROM (
  tbl_tax_species ts,
  tbl_tax_rank ttr
 )
 LEFT JOIN tbl_tax_authors ta ON ta.authorID=ts.authorID
 LEFT JOIN tbl_tax_authors ta1 ON ta1.authorID=ts.subspecies_authorID
 LEFT JOIN tbl_tax_authors ta2 ON ta2.authorID=ts.variety_authorID
 LEFT JOIN tbl_tax_authors ta3 ON ta3.authorID=ts.subvariety_authorID
 LEFT JOIN tbl_tax_authors ta4 ON ta4.authorID=ts.forma_authorID
 LEFT JOIN tbl_tax_authors ta5 ON ta5.authorID=ts.subforma_authorID
 
 LEFT JOIN tbl_tax_epithets te ON te.epithetID=ts.speciesID
 LEFT JOIN tbl_tax_epithets te1 ON te1.epithetID=ts.subspeciesID
 LEFT JOIN tbl_tax_epithets te2 ON te2.epithetID=ts.varietyID
 LEFT JOIN tbl_tax_epithets te3 ON te3.epithetID=ts.subvarietyID
 LEFT JOIN tbl_tax_epithets te4 ON te4.epithetID=ts.formaID
 LEFT JOIN tbl_tax_epithets te5 ON te5.epithetID=ts.subformaID
 
 LEFT JOIN tbl_tax_genera tg ON tg.genID=ts.genID
 LEFT JOIN tbl_tax_families tf ON tf.familyID=tg.familyID
 LEFT JOIN tbl_tax_status tts ON tts.statusID=ts.statusID

WHERE
 ts.tax_rankID=ttr.tax_rankID
 AND tf.familyID='30'
 AND ts.statusID!='2'
 AND ttr.tax_rankID!='24'
 AND ttr.tax_rankID!='8'